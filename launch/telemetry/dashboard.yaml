# Grafana Dashboard Configuration
# AI Agent Collaboration Platform Telemetry & TTF Metrics

apiVersion: 1

providers:
  - name: 'AI Agent Collaboration Platform'
    orgId: 1
    folder: 'Telemetry & TTF'
    type: file
    disableDeletion: false
    updateIntervalSeconds: 10
    allowUiUpdates: true
    options:
      path: /var/lib/grafana/dashboards

dashboards:
  - name: 'TTF Metrics Overview'
    uid: ttf-overview
    title: 'TTF Metrics Overview'
    tags: ['telemetry', 'ttf', 'overview']
    timezone: 'browser'
    refresh: '30s'
    schemaVersion: 38
    version: 1
    time:
      from: 'now-24h'
      to: 'now'
    
    panels:
      # TTF Completion Rate
      - id: 1
        title: 'TTF Completion Rate'
        type: 'stat'
        gridPos:
          h: 8
          w: 6
          x: 0
          y: 0
        targets:
          - expr: 'rate(ttf_completion_total[5m])'
            legendFormat: 'Completions/sec'
        fieldConfig:
          defaults:
            color:
              mode: 'palette-classic'
            custom:
              displayMode: 'gradient-gauge'
              gradientMode: 'scheme'
            thresholds:
              steps:
                - color: 'red'
                  value: null
                - color: 'yellow'
                  value: 0.7
                - color: 'green'
                  value: 0.9
        options:
          colorMode: 'value'
          graphMode: 'area'
          justifyMode: 'auto'
          orientation: 'auto'
          reduceOptions:
            calcs: ['lastNotNull']
            fields: ''
            values: false
          textMode: 'auto'
        
      # Average TTF
      - id: 2
        title: 'Average TTF (minutes)'
        type: 'stat'
        gridPos:
          h: 8
          w: 6
          x: 6
          y: 0
        targets:
          - expr: 'avg(ttf_complete_minutes)'
            legendFormat: 'Avg TTF'
        fieldConfig:
          defaults:
            color:
              mode: 'thresholds'
            thresholds:
              steps:
                - color: 'green'
                  value: null
                - color: 'yellow'
                  value: 45
                - color: 'red'
                  value: 60
        options:
          colorMode: 'value'
          graphMode: 'area'
          justifyMode: 'auto'
          orientation: 'auto'
          reduceOptions:
            calcs: ['lastNotNull']
            fields: ''
            values: false
          textMode: 'auto'
        
      # TTF Distribution
      - id: 3
        title: 'TTF Distribution'
        type: 'histogram'
        gridPos:
          h: 8
          w: 12
          x: 12
          y: 0
        targets:
          - expr: 'histogram_quantile(0.5, rate(ttf_complete_bucket[5m]))'
            legendFormat: '50th percentile'
          - expr: 'histogram_quantile(0.9, rate(ttf_complete_bucket[5m]))'
            legendFormat: '90th percentile'
          - expr: 'histogram_quantile(0.95, rate(ttf_complete_bucket[5m]))'
            legendFormat: '95th percentile'
        fieldConfig:
          defaults:
            color:
              mode: 'palette-classic'
            custom:
              axisLabel: 'TTF (minutes)'
              axisPlacement: 'auto'
              barAlignment: 0
              drawStyle: 'line'
              fillOpacity: 10
              gradientMode: 'none'
              hideFrom:
                legend: false
                tooltip: false
                vis: false
              lineInterpolation: 'linear'
              lineWidth: 1
              pointSize: 5
              scaleDistribution:
                type: 'linear'
              showPoints: 'never'
              spanNulls: false
              stacking:
                group: 'A'
                mode: 'none'
              thresholdsStyle:
                mode: 'off'
            thresholds:
              steps:
                - color: 'green'
                  value: null
                - color: 'red'
                  value: 80
        options:
          legend:
            calcs: []
            displayMode: 'list'
            placement: 'bottom'
            showLegend: true
          tooltip:
            mode: 'single'
            sort: 'none'
        
      # TTF by Stage
      - id: 4
        title: 'TTF by Stage'
        type: 'timeseries'
        gridPos:
          h: 8
          w: 24
          x: 0
          y: 8
        targets:
          - expr: 'avg(ttf_project_minutes)'
            legendFormat: 'Project Creation'
          - expr: 'avg(ttf_agent_minutes)'
            legendFormat: 'Agent Creation'
          - expr: 'avg(ttf_workflow_minutes)'
            legendFormat: 'Workflow Execution'
          - expr: 'avg(ttf_success_minutes)'
            legendFormat: 'Success Achievement'
        fieldConfig:
          defaults:
            color:
              mode: 'palette-classic'
            custom:
              axisLabel: 'Time (minutes)'
              axisPlacement: 'auto'
              barAlignment: 0
              drawStyle: 'line'
              fillOpacity: 10
              gradientMode: 'none'
              hideFrom:
                legend: false
                tooltip: false
                vis: false
              lineInterpolation: 'linear'
              lineWidth: 2
              pointSize: 5
              scaleDistribution:
                type: 'linear'
              showPoints: 'auto'
              spanNulls: false
              stacking:
                group: 'A'
                mode: 'none'
              thresholdsStyle:
                mode: 'off'
            thresholds:
              steps:
                - color: 'green'
                  value: null
                - color: 'red'
                  value: 80
        options:
          legend:
            calcs: []
            displayMode: 'list'
            placement: 'bottom'
            showLegend: true
          tooltip:
            mode: 'single'
            sort: 'none'
        
      # User Journey Funnel
      - id: 5
        title: 'User Journey Funnel'
        type: 'barchart'
        gridPos:
          h: 8
          w: 12
          x: 0
          y: 16
        targets:
          - expr: 'sum(user_signup_total)'
            legendFormat: 'Signup'
          - expr: 'sum(first_project_created_total)'
            legendFormat: 'First Project'
          - expr: 'sum(first_agent_created_total)'
            legendFormat: 'First Agent'
          - expr: 'sum(first_workflow_executed_total)'
            legendFormat: 'First Workflow'
          - expr: 'sum(first_success_event_total)'
            legendFormat: 'First Success'
        fieldConfig:
          defaults:
            color:
              mode: 'palette-classic'
            custom:
              axisLabel: 'Users'
              axisPlacement: 'auto'
              barAlignment: 0
              barWidth: 0.97
              drawStyle: 'bars'
              fillOpacity: 100
              gradientMode: 'none'
              hideFrom:
                legend: false
                tooltip: false
                vis: false
              lineInterpolation: 'linear'
              lineWidth: 1
              pointSize: 5
              scaleDistribution:
                type: 'linear'
              showPoints: 'never'
              spanNulls: false
              stacking:
                group: 'A'
                mode: 'none'
              thresholdsStyle:
                mode: 'off'
        options:
          legend:
            calcs: []
            displayMode: 'list'
            placement: 'bottom'
            showLegend: true
          tooltip:
            mode: 'single'
            sort: 'none'
        
      # TTF Efficiency Score
      - id: 6
        title: 'TTF Efficiency Score'
        type: 'gauge'
        gridPos:
          h: 8
          w: 12
          x: 12
          y: 16
        targets:
          - expr: 'avg(ttf_efficiency_score)'
            legendFormat: 'Efficiency Score'
        fieldConfig:
          defaults:
            color:
              mode: 'thresholds'
            thresholds:
              steps:
                - color: 'red'
                  value: null
                - color: 'yellow'
                  value: 60
                - color: 'green'
                  value: 80
            unit: 'percent'
            min: 0
            max: 100
        options:
          orientation: 'auto'
          reduceOptions:
            calcs: ['lastNotNull']
            fields: ''
            values: false
          showThresholdLabels: false
          showThresholdMarkers: true
        
      # Real-time TTF Alerts
      - id: 7
        title: 'TTF Alerts (Last Hour)'
        type: 'table'
        gridPos:
          h: 8
          w: 24
          x: 0
          y: 24
        targets:
          - expr: 'ttf_alert_total'
            legendFormat: '{{alert_level}}'
            format: 'table'
        fieldConfig:
          defaults:
            color:
              mode: 'thresholds'
            thresholds:
              steps:
                - color: 'green'
                  value: null
                - color: 'yellow'
                  value: 1
                - color: 'red'
                  value: 5
        options:
          showHeader: true
          sortBy:
            - desc: true
              displayName: 'Count'
        
      # Performance Metrics
      - id: 8
        title: 'Performance Metrics'
        type: 'timeseries'
        gridPos:
          h: 8
          w: 24
          x: 0
          y: 32
        targets:
          - expr: 'rate(api_request_duration_seconds[5m])'
            legendFormat: 'API Response Time'
          - expr: 'rate(agent_startup_time_seconds[5m])'
            legendFormat: 'Agent Startup Time'
          - expr: 'rate(workflow_execution_time_seconds[5m])'
            legendFormat: 'Workflow Execution Time'
        fieldConfig:
          defaults:
            color:
              mode: 'palette-classic'
            custom:
              axisLabel: 'Time (seconds)'
              axisPlacement: 'auto'
              barAlignment: 0
              drawStyle: 'line'
              fillOpacity: 10
              gradientMode: 'none'
              hideFrom:
                legend: false
                tooltip: false
                vis: false
              lineInterpolation: 'linear'
              lineWidth: 2
              pointSize: 5
              scaleDistribution:
                type: 'linear'
              showPoints: 'auto'
              spanNulls: false
              stacking:
                group: 'A'
                mode: 'none'
              thresholdsStyle:
                mode: 'off'
            thresholds:
              steps:
                - color: 'green'
                  value: null
                - color: 'red'
                  value: 80
        options:
          legend:
            calcs: []
            displayMode: 'list'
            placement: 'bottom'
            showLegend: true
          tooltip:
            mode: 'single'
            sort: 'none'
        
      # Error Rate
      - id: 9
        title: 'Error Rate'
        type: 'timeseries'
        gridPos:
          h: 8
          w: 12
          x: 0
          y: 40
        targets:
          - expr: 'rate(error_total[5m])'
            legendFormat: 'Errors/sec'
        fieldConfig:
          defaults:
            color:
              mode: 'thresholds'
            thresholds:
              steps:
                - color: 'green'
                  value: null
                - color: 'yellow'
                  value: 0.01
                - color: 'red'
                  value: 0.05
            custom:
              axisLabel: 'Errors/sec'
              axisPlacement: 'auto'
              barAlignment: 0
              drawStyle: 'line'
              fillOpacity: 10
              gradientMode: 'none'
              hideFrom:
                legend: false
                tooltip: false
                vis: false
              lineInterpolation: 'linear'
              lineWidth: 2
              pointSize: 5
              scaleDistribution:
                type: 'linear'
              showPoints: 'auto'
              spanNulls: false
              stacking:
                group: 'A'
                mode: 'none'
              thresholdsStyle:
                mode: 'off'
        options:
          legend:
            calcs: []
            displayMode: 'list'
            placement: 'bottom'
            showLegend: true
          tooltip:
            mode: 'single'
            sort: 'none'
        
      # User Activity
      - id: 10
        title: 'User Activity'
        type: 'timeseries'
        gridPos:
          h: 8
          w: 12
          x: 12
          y: 40
        targets:
          - expr: 'rate(user_action_total[5m])'
            legendFormat: 'User Actions/sec'
          - expr: 'rate(system_event_total[5m])'
            legendFormat: 'System Events/sec'
        fieldConfig:
          defaults:
            color:
              mode: 'palette-classic'
            custom:
              axisLabel: 'Events/sec'
              axisPlacement: 'auto'
              barAlignment: 0
              drawStyle: 'line'
              fillOpacity: 10
              gradientMode: 'none'
              hideFrom:
                legend: false
                tooltip: false
                vis: false
              lineInterpolation: 'linear'
              lineWidth: 2
              pointSize: 5
              scaleDistribution:
                type: 'linear'
              showPoints: 'auto'
              spanNulls: false
              stacking:
                group: 'A'
                mode: 'none'
              thresholdsStyle:
                mode: 'off'
        options:
          legend:
            calcs: []
            displayMode: 'list'
            placement: 'bottom'
            showLegend: true
          tooltip:
            mode: 'single'
            sort: 'none'

  - name: 'TTF Detailed Analysis'
    uid: ttf-detailed
    title: 'TTF Detailed Analysis'
    tags: ['telemetry', 'ttf', 'detailed']
    timezone: 'browser'
    refresh: '1m'
    schemaVersion: 38
    version: 1
    time:
      from: 'now-7d'
      to: 'now'
    
    panels:
      # TTF Heatmap
      - id: 11
        title: 'TTF Heatmap by Hour'
        type: 'heatmap'
        gridPos:
          h: 8
          w: 24
          x: 0
          y: 0
        targets:
          - expr: 'sum(rate(ttf_complete_bucket[1h])) by (le, hour)'
            legendFormat: '{{le}}'
            format: 'heatmap'
        fieldConfig:
          defaults:
            color:
              mode: 'scheme'
              schemeName: 'Spectral'
            custom:
              hideFrom:
                legend: false
                tooltip: false
                vis: false
        options:
          calculate: true
          calculation:
            xBuckets:
              mode: 'size'
              value: '1'
            yBuckets:
              mode: 'size'
              value: '1'
          color:
            mode: 'scheme'
            schemeName: 'Spectral'
          legend:
            show: true
          tooltip:
            show: true
            yHistogram: false
          yAxis:
            unit: 'minutes'
        
      # TTF by User Segment
      - id: 12
        title: 'TTF by User Segment'
        type: 'barchart'
        gridPos:
          h: 8
          w: 12
          x: 0
          y: 8
        targets:
          - expr: 'avg(ttf_complete_minutes) by (user_type)'
            legendFormat: '{{user_type}}'
        fieldConfig:
          defaults:
            color:
              mode: 'palette-classic'
            custom:
              axisLabel: 'TTF (minutes)'
              axisPlacement: 'auto'
              barAlignment: 0
              barWidth: 0.97
              drawStyle: 'bars'
              fillOpacity: 100
              gradientMode: 'none'
              hideFrom:
                legend: false
                tooltip: false
                vis: false
              lineInterpolation: 'linear'
              lineWidth: 1
              pointSize: 5
              scaleDistribution:
                type: 'linear'
              showPoints: 'never'
              spanNulls: false
              stacking:
                group: 'A'
                mode: 'none'
              thresholdsStyle:
                mode: 'off'
        options:
          legend:
            calcs: []
            displayMode: 'list'
            placement: 'bottom'
            showLegend: true
          tooltip:
            mode: 'single'
            sort: 'none'
        
      # TTF by Channel
      - id: 13
        title: 'TTF by Acquisition Channel'
        type: 'barchart'
        gridPos:
          h: 8
          w: 12
          x: 12
          y: 8
        targets:
          - expr: 'avg(ttf_complete_minutes) by (acquisition_channel)'
            legendFormat: '{{acquisition_channel}}'
        fieldConfig:
          defaults:
            color:
              mode: 'palette-classic'
            custom:
              axisLabel: 'TTF (minutes)'
              axisPlacement: 'auto'
              barAlignment: 0
              barWidth: 0.97
              drawStyle: 'bars'
              fillOpacity: 100
              gradientMode: 'none'
              hideFrom:
                legend: false
                tooltip: false
                vis: false
              lineInterpolation: 'linear'
              lineWidth: 1
              pointSize: 5
              scaleDistribution:
                type: 'linear'
              showPoints: 'never'
              spanNulls: false
              stacking:
                group: 'A'
                mode: 'none'
              thresholdsStyle:
                mode: 'off'
        options:
          legend:
            calcs: []
            displayMode: 'list'
            placement: 'bottom'
            showLegend: true
          tooltip:
            mode: 'single'
            sort: 'none'
        
      # TTF Trends
      - id: 14
        title: 'TTF Trends Over Time'
        type: 'timeseries'
        gridPos:
          h: 8
          w: 24
          x: 0
          y: 16
        targets:
          - expr: 'avg(ttf_complete_minutes)'
            legendFormat: 'Average TTF'
          - expr: 'quantile(0.5, ttf_complete_minutes)'
            legendFormat: 'Median TTF'
          - expr: 'quantile(0.9, ttf_complete_minutes)'
            legendFormat: '90th Percentile TTF'
        fieldConfig:
          defaults:
            color:
              mode: 'palette-classic'
            custom:
              axisLabel: 'TTF (minutes)'
              axisPlacement: 'auto'
              barAlignment: 0
              drawStyle: 'line'
              fillOpacity: 10
              gradientMode: 'none'
              hideFrom:
                legend: false
                tooltip: false
                vis: false
              lineInterpolation: 'linear'
              lineWidth: 2
              pointSize: 5
              scaleDistribution:
                type: 'linear'
              showPoints: 'auto'
              spanNulls: false
              stacking:
                group: 'A'
                mode: 'none'
              thresholdsStyle:
                mode: 'off'
        options:
          legend:
            calcs: []
            displayMode: 'list'
            placement: 'bottom'
            showLegend: true
          tooltip:
            mode: 'single'
            sort: 'none'

  - name: 'Telemetry System Health'
    uid: telemetry-health
    title: 'Telemetry System Health'
    tags: ['telemetry', 'system', 'health']
    timezone: 'browser'
    refresh: '30s'
    schemaVersion: 38
    version: 1
    time:
      from: 'now-1h'
      to: 'now'
    
    panels:
      # System Status
      - id: 15
        title: 'System Status'
        type: 'stat'
        gridPos:
          h: 8
          w: 6
          x: 0
          y: 0
        targets:
          - expr: 'up{job="telemetry"}'
            legendFormat: 'Telemetry Service'
        fieldConfig:
          defaults:
            color:
              mode: 'thresholds'
            thresholds:
              steps:
                - color: 'red'
                  value: null
                - color: 'green'
                  value: 1
        options:
          colorMode: 'value'
          graphMode: 'area'
          justifyMode: 'auto'
          orientation: 'auto'
          reduceOptions:
            calcs: ['lastNotNull']
            fields: ''
            values: false
          textMode: 'auto'
        
      # Event Processing Rate
      - id: 16
        title: 'Event Processing Rate'
        type: 'stat'
        gridPos:
          h: 8
          w: 6
          x: 6
          y: 0
        targets:
          - expr: 'rate(events_processed_total[5m])'
            legendFormat: 'Events/sec'
        fieldConfig:
          defaults:
            color:
              mode: 'thresholds'
            thresholds:
              steps:
                - color: 'red'
                  value: null
                - color: 'green'
                  value: 100
        options:
          colorMode: 'value'
          graphMode: 'area'
          justifyMode: 'auto'
          orientation: 'auto'
          reduceOptions:
            calcs: ['lastNotNull']
            fields: ''
            values: false
          textMode: 'auto'
        
      # Error Rate
      - id: 17
        title: 'Error Rate'
        type: 'stat'
        gridPos:
          h: 8
          w: 6
          x: 12
          y: 0
        targets:
          - expr: 'rate(telemetry_errors_total[5m])'
            legendFormat: 'Errors/sec'
        fieldConfig:
          defaults:
            color:
              mode: 'thresholds'
            thresholds:
              steps:
                - color: 'green'
                  value: null
                - color: 'yellow'
                  value: 0.01
                - color: 'red'
                  value: 0.1
        options:
          colorMode: 'value'
          graphMode: 'area'
          justifyMode: 'auto'
          orientation: 'auto'
          reduceOptions:
            calcs: ['lastNotNull']
            fields: ''
            values: false
          textMode: 'auto'
        
      # Latency
      - id: 18
        title: 'Processing Latency'
        type: 'stat'
        gridPos:
          h: 8
          w: 6
          x: 18
          y: 0
        targets:
          - expr: 'histogram_quantile(0.95, rate(event_processing_duration_seconds_bucket[5m]))'
            legendFormat: '95th percentile'
        fieldConfig:
          defaults:
            color:
              mode: 'thresholds'
            thresholds:
              steps:
                - color: 'green'
                  value: null
                - color: 'yellow'
                  value: 0.1
                - color: 'red'
                  value: 0.5
            unit: 's'
        options:
          colorMode: 'value'
          graphMode: 'area'
          justifyMode: 'auto'
          orientation: 'auto'
          reduceOptions:
            calcs: ['lastNotNull']
            fields: ''
            values: false
          textMode: 'auto'
        
      # System Metrics
      - id: 19
        title: 'System Metrics'
        type: 'timeseries'
        gridPos:
          h: 8
          w: 24
          x: 0
          y: 8
        targets:
          - expr: 'rate(events_processed_total[5m])'
            legendFormat: 'Events Processed/sec'
          - expr: 'rate(events_dropped_total[5m])'
            legendFormat: 'Events Dropped/sec'
          - expr: 'rate(events_invalid_total[5m])'
            legendFormat: 'Invalid Events/sec'
        fieldConfig:
          defaults:
            color:
              mode: 'palette-classic'
            custom:
              axisLabel: 'Events/sec'
              axisPlacement: 'auto'
              barAlignment: 0
              drawStyle: 'line'
              fillOpacity: 10
              gradientMode: 'none'
              hideFrom:
                legend: false
                tooltip: false
                vis: false
              lineInterpolation: 'linear'
              lineWidth: 2
              pointSize: 5
              scaleDistribution:
                type: 'linear'
              showPoints: 'auto'
              spanNulls: false
              stacking:
                group: 'A'
                mode: 'none'
              thresholdsStyle:
                mode: 'off'
        options:
          legend:
            calcs: []
            displayMode: 'list'
            placement: 'bottom'
            showLegend: true
          tooltip:
            mode: 'single'
            sort: 'none'